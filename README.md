
--- NOT PRODUCTION READY ---

# Multikey <-> WebCrypto and JWK conversions


Conversion of cryptographic keys in [Multikey format](https://www.w3.org/TR/controller-document/#multikey) to and
from [WebCrypto](https://www.w3.org/TR/WebCryptoAPI/) and [JWK](https://datatracker.ietf.org/doc/html/rfc7517). The conversions are available for the three EC curves that are defined for Verifiable Credentials:
[ECDSA with P-256 and P-384](https://www.w3.org/TR/vc-di-ecdsa/#multikey) and [EDDSA](https://www.w3.org/TR/vc-di-eddsa/#multikey). 

This is really a proof-of-concept implementation. It shows that such conversion _can indeed be done_, 
which is an important in proving the practical usability of multikeys.

The package has been written in TypeScript+Node.js. (There is also a Deno version.)

For a more detailed documentation, see the [code documentation](https://iherman.github.io/multikey-webcrypto/), generated by typedoc. A short set of examples may help.

## Convert public/secret pairs to and from Multikey and JWK

```typescript
import * as mkc from "multikey-webcrypto";

// Convert a JWK Pair to a Multikey Pair:
const jwk_pair: JWKKeyPair = {
    public: your_jwk_public_key,
    secret: your_jwk_secret_key,
};
const mk_pair: MultikeyPair = mkc.JWKToMultikey(jwk_pair);
// mk_pair.publicKeyMultibase and mk_pair.secretKeyMultibase provide the right values

// Convert the multikey back to jwk
const generated_jwk_pair: JWKKeyPair = mkc.multikeyToJWK(mk_pair);

```

In all cases the secret key may be missing or `undefined`, so that only the public key is converted. The same can be achieved if the same functions are uses with an overloaded signature:

```typescript
import * as mkc from "multikey-webcrypto";

const mk: Multikey = mkc.JWKToMultikey(your_jwk_public_key);
// mk the encoded value

// Convert the multikey back to jwk
const generated_jwk_public_key: JWKKeyPair = mkc.multikeyToJWK(mk);
```

## Convert public/secret pairs to and from Multikey and WebCrypto keys

```typescript
import * as mkc from "multikey-webcrypto";

// Convert a JWK Pair to a Multikey Pair:
const crypto_pair: CryptoKeyPair = {
    public: your_web_crypto_public_key,
    secret: your_web_crypto_secret_key,
};
const mk_pair: MultikeyPair = await mkc.cryptoToMultikey(crypto_pair);
// mk_pair.publicKeyMultibase and mk_pair.secretKeyMultibase provide the right values

// Convert the multikey back to jwk
const generated_crypto_pair: JWKKeyPair = await mkc.multikeyToCrypto(mk_pair);
```

Note the usage of `await`: WebCrypto implementations are using asynchronous functions, hence the asynchronous nature of these functions in `multikey-webcrypto` as well.

Similarly to the JWK case, handling public keys can also be done with the aliased versions of the same functions:

```typescript
import * as mkc from "multikey-webcrypto";

const mk: Multikey = mkc.cryptoToMultikey(your_web_crypto_public_key);
// mk the encoded value

// Convert the multikey back to jwk
const generated_crypto_key: JWKKeyPair = mkc.multikeyToJWK(mk);
```
